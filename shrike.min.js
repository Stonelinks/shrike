(function(){var n=this,r=n._,t={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,v=e.reduce,h=e.reduceRight,m=e.filter,d=e.every,g=e.some,y=e.indexOf,w=e.lastIndexOf,_=Array.isArray,x=Object.keys,b=i.bind,k=function(n){return n instanceof k?n:this instanceof k?(this._wrapped=n,void 0):new k(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):n._=k,k.VERSION="1.6.0";var A=k.each=k.forEach=function(n,r,e){if(null==n)return n;if(s&&n.forEach===s)n.forEach(r,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(r.call(e,n[u],u,n)===t)return}else for(var a=k.keys(n),u=0,i=a.length;i>u;u++)if(r.call(e,n[a[u]],a[u],n)===t)return;return n};k.map=k.collect=function(n,r,t){var e=[];return null==n?e:p&&n.map===p?n.map(r,t):(A(n,function(n,u,i){e.push(r.call(t,n,u,i))}),e)};var j="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(n,r,t,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduce===v)return e&&(r=k.bind(r,e)),u?n.reduce(r,t):n.reduce(r);if(A(n,function(n,i,a){u?t=r.call(e,t,n,i,a):(t=n,u=!0)}),!u)throw new TypeError(j);return t},k.reduceRight=k.foldr=function(n,r,t,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduceRight===h)return e&&(r=k.bind(r,e)),u?n.reduceRight(r,t):n.reduceRight(r);var i=n.length;if(i!==+i){var a=k.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?t=r.call(e,t,n[c],c,l):(t=n[c],u=!0)}),!u)throw new TypeError(j);return t},k.find=k.detect=function(n,r,t){var e;return O(n,function(n,u,i){return r.call(t,n,u,i)?(e=n,!0):void 0}),e},k.filter=k.select=function(n,r,t){var e=[];return null==n?e:m&&n.filter===m?n.filter(r,t):(A(n,function(n,u,i){r.call(t,n,u,i)&&e.push(n)}),e)},k.reject=function(n,r,t){return k.filter(n,function(n,e,u){return!r.call(t,n,e,u)},t)},k.every=k.all=function(n,r,e){r||(r=k.identity);var u=!0;return null==n?u:d&&n.every===d?n.every(r,e):(A(n,function(n,i,a){return(u=u&&r.call(e,n,i,a))?void 0:t}),!!u)};var O=k.some=k.any=function(n,r,e){r||(r=k.identity);var u=!1;return null==n?u:g&&n.some===g?n.some(r,e):(A(n,function(n,i,a){return u||(u=r.call(e,n,i,a))?t:void 0}),!!u)};k.contains=k.include=function(n,r){return null==n?!1:y&&n.indexOf===y?-1!=n.indexOf(r):O(n,function(n){return n===r})},k.invoke=function(n,r){var t=o.call(arguments,2),e=k.isFunction(r);return k.map(n,function(n){return(e?r:n[r]).apply(n,t)})},k.pluck=function(n,r){return k.map(n,k.property(r))},k.where=function(n,r){return k.filter(n,k.matches(r))},k.findWhere=function(n,r){return k.find(n,k.matches(r))},k.max=function(n,r,t){if(!r&&k.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);var e=-1/0,u=-1/0;return A(n,function(n,i,a){var o=r?r.call(t,n,i,a):n;o>u&&(e=n,u=o)}),e},k.min=function(n,r,t){if(!r&&k.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);var e=1/0,u=1/0;return A(n,function(n,i,a){var o=r?r.call(t,n,i,a):n;u>o&&(e=n,u=o)}),e},k.shuffle=function(n){var r,t=0,e=[];return A(n,function(n){r=k.random(t++),e[t-1]=e[r],e[r]=n}),e},k.sample=function(n,r,t){return null==r||t?(n.length!==+n.length&&(n=k.values(n)),n[k.random(n.length-1)]):k.shuffle(n).slice(0,Math.max(0,r))};var M=function(n){return null==n?k.identity:k.isFunction(n)?n:k.property(n)};k.sortBy=function(n,r,t){return r=M(r),k.pluck(k.map(n,function(n,e,u){return{value:n,index:e,criteria:r.call(t,n,e,u)}}).sort(function(n,r){var t=n.criteria,e=r.criteria;if(t!==e){if(t>e||void 0===t)return 1;if(e>t||void 0===e)return-1}return n.index-r.index}),"value")};var S=function(n){return function(r,t,e){var u={};return t=M(t),A(r,function(i,a){var o=t.call(e,i,a,r);n(u,o,i)}),u}};k.groupBy=S(function(n,r,t){k.has(n,r)?n[r].push(t):n[r]=[t]}),k.indexBy=S(function(n,r,t){n[r]=t}),k.countBy=S(function(n,r){k.has(n,r)?n[r]++:n[r]=1}),k.sortedIndex=function(n,r,t,e){t=M(t);for(var u=t.call(e,r),i=0,a=n.length;a>i;){var o=i+a>>>1;t.call(e,n[o])<u?i=o+1:a=o}return i},k.toArray=function(n){return n?k.isArray(n)?o.call(n):n.length===+n.length?k.map(n,k.identity):k.values(n):[]},k.size=function(n){return null==n?0:n.length===+n.length?n.length:k.keys(n).length},k.first=k.head=k.take=function(n,r,t){return null==n?void 0:null==r||t?n[0]:0>r?[]:o.call(n,0,r)},k.initial=function(n,r,t){return o.call(n,0,n.length-(null==r||t?1:r))},k.last=function(n,r,t){return null==n?void 0:null==r||t?n[n.length-1]:o.call(n,Math.max(n.length-r,0))},k.rest=k.tail=k.drop=function(n,r,t){return o.call(n,null==r||t?1:r)},k.compact=function(n){return k.filter(n,k.identity)};var F=function(n,r,t){return r&&k.every(n,k.isArray)?c.apply(t,n):(A(n,function(n){k.isArray(n)||k.isArguments(n)?r?a.apply(t,n):F(n,r,t):t.push(n)}),t)};k.flatten=function(n,r){return F(n,r,[])},k.without=function(n){return k.difference(n,o.call(arguments,1))},k.partition=function(n,r){var t=[],e=[];return A(n,function(n){(r(n)?t:e).push(n)}),[t,e]},k.uniq=k.unique=function(n,r,t,e){k.isFunction(r)&&(e=t,t=r,r=!1);var u=t?k.map(n,t,e):n,i=[],a=[];return A(u,function(t,e){(r?e&&a[a.length-1]===t:k.contains(a,t))||(a.push(t),i.push(n[e]))}),i},k.union=function(){return k.uniq(k.flatten(arguments,!0))},k.intersection=function(n){var r=o.call(arguments,1);return k.filter(k.uniq(n),function(n){return k.every(r,function(r){return k.contains(r,n)})})},k.difference=function(n){var r=c.apply(e,o.call(arguments,1));return k.filter(n,function(n){return!k.contains(r,n)})},k.zip=function(){for(var n=k.max(k.pluck(arguments,"length").concat(0)),r=new Array(n),t=0;n>t;t++)r[t]=k.pluck(arguments,""+t);return r},k.object=function(n,r){if(null==n)return{};for(var t={},e=0,u=n.length;u>e;e++)r?t[n[e]]=r[e]:t[n[e][0]]=n[e][1];return t},k.indexOf=function(n,r,t){if(null==n)return-1;var e=0,u=n.length;if(t){if("number"!=typeof t)return e=k.sortedIndex(n,r),n[e]===r?e:-1;e=0>t?Math.max(0,u+t):t}if(y&&n.indexOf===y)return n.indexOf(r,t);for(;u>e;e++)if(n[e]===r)return e;return-1},k.lastIndexOf=function(n,r,t){if(null==n)return-1;var e=null!=t;if(w&&n.lastIndexOf===w)return e?n.lastIndexOf(r,t):n.lastIndexOf(r);for(var u=e?t:n.length;u--;)if(n[u]===r)return u;return-1},k.range=function(n,r,t){arguments.length<=1&&(r=n||0,n=0),t=arguments[2]||1;for(var e=Math.max(Math.ceil((r-n)/t),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=t;return i};var E=function(){};k.bind=function(n,r){var t,e;if(b&&n.bind===b)return b.apply(n,o.call(arguments,1));if(!k.isFunction(n))throw new TypeError;return t=o.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(r,t.concat(o.call(arguments)));E.prototype=n.prototype;var u=new E;E.prototype=null;var i=n.apply(u,t.concat(o.call(arguments)));return Object(i)===i?i:u}},k.partial=function(n){var r=o.call(arguments,1);return function(){for(var t=0,e=r.slice(),u=0,i=e.length;i>u;u++)e[u]===k&&(e[u]=arguments[t++]);for(;t<arguments.length;)e.push(arguments[t++]);return n.apply(this,e)}},k.bindAll=function(n){var r=o.call(arguments,1);if(0===r.length)throw new Error("bindAll must be passed function names");return A(r,function(r){n[r]=k.bind(n[r],n)}),n},k.memoize=function(n,r){var t={};return r||(r=k.identity),function(){var e=r.apply(this,arguments);return k.has(t,e)?t[e]:t[e]=n.apply(this,arguments)}},k.delay=function(n,r){var t=o.call(arguments,2);return setTimeout(function(){return n.apply(null,t)},r)},k.defer=function(n){return k.delay.apply(k,[n,1].concat(o.call(arguments,1)))},k.throttle=function(n,r,t){var e,u,i,a=null,o=0;t||(t={});var c=function(){o=t.leading===!1?0:k.now(),a=null,i=n.apply(e,u),e=u=null};return function(){var l=k.now();o||t.leading!==!1||(o=l);var f=r-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u),e=u=null):a||t.trailing===!1||(a=setTimeout(c,f)),i}},k.debounce=function(n,r,t){var e,u,i,a,o,c=function(){var l=k.now()-a;r>l?e=setTimeout(c,r-l):(e=null,t||(o=n.apply(i,u),i=u=null))};return function(){i=this,u=arguments,a=k.now();var l=t&&!e;return e||(e=setTimeout(c,r)),l&&(o=n.apply(i,u),i=u=null),o}},k.once=function(n){var r,t=!1;return function(){return t?r:(t=!0,r=n.apply(this,arguments),n=null,r)}},k.wrap=function(n,r){return k.partial(r,n)},k.compose=function(){var n=arguments;return function(){for(var r=arguments,t=n.length-1;t>=0;t--)r=[n[t].apply(this,r)];return r[0]}},k.after=function(n,r){return function(){return--n<1?r.apply(this,arguments):void 0}},k.keys=function(n){if(!k.isObject(n))return[];if(x)return x(n);var r=[];for(var t in n)k.has(n,t)&&r.push(t);return r},k.values=function(n){for(var r=k.keys(n),t=r.length,e=new Array(t),u=0;t>u;u++)e[u]=n[r[u]];return e},k.pairs=function(n){for(var r=k.keys(n),t=r.length,e=new Array(t),u=0;t>u;u++)e[u]=[r[u],n[r[u]]];return e},k.invert=function(n){for(var r={},t=k.keys(n),e=0,u=t.length;u>e;e++)r[n[t[e]]]=t[e];return r},k.functions=k.methods=function(n){var r=[];for(var t in n)k.isFunction(n[t])&&r.push(t);return r.sort()},k.extend=function(n){return A(o.call(arguments,1),function(r){if(r)for(var t in r)n[t]=r[t]}),n},k.pick=function(n){var r={},t=c.apply(e,o.call(arguments,1));return A(t,function(t){t in n&&(r[t]=n[t])}),r},k.omit=function(n){var r={},t=c.apply(e,o.call(arguments,1));for(var u in n)k.contains(t,u)||(r[u]=n[u]);return r},k.defaults=function(n){return A(o.call(arguments,1),function(r){if(r)for(var t in r)void 0===n[t]&&(n[t]=r[t])}),n},k.clone=function(n){return k.isObject(n)?k.isArray(n)?n.slice():k.extend({},n):n},k.tap=function(n,r){return r(n),n};var T=function(n,r,t,e){if(n===r)return 0!==n||1/n==1/r;if(null==n||null==r)return n===r;n instanceof k&&(n=n._wrapped),r instanceof k&&(r=r._wrapped);var u=l.call(n);if(u!=l.call(r))return!1;switch(u){case"[object String]":return n==String(r);case"[object Number]":return n!=+n?r!=+r:0==n?1/n==1/r:n==+r;case"[object Date]":case"[object Boolean]":return+n==+r;case"[object RegExp]":return n.source==r.source&&n.global==r.global&&n.multiline==r.multiline&&n.ignoreCase==r.ignoreCase}if("object"!=typeof n||"object"!=typeof r)return!1;for(var i=t.length;i--;)if(t[i]==n)return e[i]==r;var a=n.constructor,o=r.constructor;if(a!==o&&!(k.isFunction(a)&&a instanceof a&&k.isFunction(o)&&o instanceof o)&&"constructor"in n&&"constructor"in r)return!1;t.push(n),e.push(r);var c=0,f=!0;if("[object Array]"==u){if(c=n.length,f=c==r.length)for(;c--&&(f=T(n[c],r[c],t,e)););}else{for(var s in n)if(k.has(n,s)&&(c++,!(f=k.has(r,s)&&T(n[s],r[s],t,e))))break;if(f){for(s in r)if(k.has(r,s)&&!c--)break;f=!c}}return t.pop(),e.pop(),f};k.isEqual=function(n,r){return T(n,r,[],[])},k.isEmpty=function(n){if(null==n)return!0;if(k.isArray(n)||k.isString(n))return 0===n.length;for(var r in n)if(k.has(n,r))return!1;return!0},k.isElement=function(n){return!(!n||1!==n.nodeType)},k.isArray=_||function(n){return"[object Array]"==l.call(n)},k.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){k["is"+n]=function(r){return l.call(r)=="[object "+n+"]"}}),k.isArguments(arguments)||(k.isArguments=function(n){return!(!n||!k.has(n,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(n){return"function"==typeof n}),k.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},k.isNaN=function(n){return k.isNumber(n)&&n!=+n},k.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},k.isNull=function(n){return null===n},k.isUndefined=function(n){return void 0===n},k.has=function(n,r){return f.call(n,r)},k.noConflict=function(){return n._=r,this},k.identity=function(n){return n},k.constant=function(n){return function(){return n}},k.property=function(n){return function(r){return r[n]}},k.matches=function(n){return function(r){if(r===n)return!0;for(var t in n)if(n[t]!==r[t])return!1;return!0}},k.times=function(n,r,t){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=r.call(t,u);return e},k.random=function(n,r){return null==r&&(r=n,n=0),n+Math.floor(Math.random()*(r-n+1))},k.now=Date.now||function(){return(new Date).getTime()};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};I.unescape=k.invert(I.escape);var R={escape:new RegExp("["+k.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(I.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(n){k[n]=function(r){return null==r?"":(""+r).replace(R[n],function(r){return I[n][r]})}}),k.result=function(n,r){if(null==n)return void 0;var t=n[r];return k.isFunction(t)?t.call(n):t},k.mixin=function(n){A(k.functions(n),function(r){var t=k[r]=n[r];k.prototype[r]=function(){var n=[this._wrapped];return a.apply(n,arguments),D.call(this,t.apply(k,n))}})};var q=0;k.uniqueId=function(n){var r=++q+"";return n?n+r:r},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var z=/(.)^/,N={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(n,r,t){var e;t=k.defaults({},t,k.templateSettings);var u=new RegExp([(t.escape||z).source,(t.interpolate||z).source,(t.evaluate||z).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(r,t,e,u,o){return a+=n.slice(i,o).replace(B,function(n){return"\\"+N[n]}),t&&(a+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+r.length,r}),a+="';\n",t.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(t.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(r)return e(r,k);var c=function(n){return e.call(this,n,k)};return c.source="function("+(t.variable||"obj")+"){\n"+a+"}",c},k.chain=function(n){return k(n).chain()};var D=function(n){return this._chain?k(n).chain():n};k.mixin(k),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var r=e[n];k.prototype[n]=function(){var t=this._wrapped;return r.apply(t,arguments),"shift"!=n&&"splice"!=n||0!==t.length||delete t[0],D.call(this,t)}}),A(["concat","join","slice"],function(n){var r=e[n];k.prototype[n]=function(){return D.call(this,r.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return k})}).call(this),define("mjs",[],function(){const n=Float32Array;var r={};r._temp1=new n(3),r._temp2=new n(3),r._temp3=new n(3),n==Array?(r.x=[1,0,0],r.y=[0,1,0],r.z=[0,0,1],r.$=function(n,r,t){return[n,r,t]},r.clone=function(n){return[n[0],n[1],n[2]]}):(r.x=new n([1,0,0]),r.y=new n([0,1,0]),r.z=new n([0,0,1]),r.$=function(r,t,e){return new n([r,t,e])},r.clone=function(r){return new n(r)}),r.u=r.x,r.v=r.y,r.add=function(r,t,e){return void 0==e&&(e=new n(3)),e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e},r.sub=function(r,t,e){return void 0==e&&(e=new n(3)),e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e},r.neg=function(r,t){return void 0==t&&(t=new n(3)),t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t},r.direction=function(t,e,u){return void 0==u&&(u=new n(3)),r.normalize(r.sub(t,e,u),u)},r.length=function(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2])},r.lengthSquared=function(n){return n[0]*n[0]+n[1]*n[1]+n[2]*n[2]},r.normalize=function(t,e){void 0==e&&(e=new n(3));var u=1/r.length(t);return e[0]=t[0]*u,e[1]=t[1]*u,e[2]=t[2]*u,e},r.scale=function(r,t,e){return void 0==e&&(e=new n(3)),e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e},r.dot=function(n,r){return n[0]*r[0]+n[1]*r[1]+n[2]*r[2]},r.cross=function(r,t,e){return void 0==e&&(e=new n(3)),e[0]=r[1]*t[2]-r[2]*t[1],e[1]=r[2]*t[0]-r[0]*t[2],e[2]=r[0]*t[1]-r[1]*t[0],e},r.mul4x4=function(t,e,u){var i,a=r._temp1;return void 0==u&&(u=new n(3)),a[0]=t[3],a[1]=t[7],a[2]=t[11],i=r.dot(e,a)+t[15],a[0]=t[0],a[1]=t[4],a[2]=t[8],u[0]=(r.dot(e,a)+t[12])/i,a[0]=t[1],a[1]=t[5],a[2]=t[9],u[1]=(r.dot(e,a)+t[13])/i,a[0]=t[2],a[1]=t[6],a[2]=t[10],u[2]=(r.dot(e,a)+t[14])/i,u};var t={};t._temp1=new n(16),t._temp2=new n(16),n==Array?(t.I=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t.$=function(n,r,t,e,u,i,a,o,c,l,f,s,p,v,h,m){return[n,r,t,e,u,i,a,o,c,l,f,s,p,v,h,m]},t.clone=function(n){return new[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15]]}):(t.I=new n([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),t.$=function(r,t,e,u,i,a,o,c,l,f,s,p,v,h,m,d){return new n([r,t,e,u,i,a,o,c,l,f,s,p,v,h,m,d])},t.clone=function(r){return new n(r)}),t.identity=t.I,t.topLeft3x3=function(r,t){return void 0==t&&(t=new n(9)),t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[4],t[4]=r[5],t[5]=r[6],t[6]=r[8],t[7]=r[9],t[8]=r[10],t},t.inverseOrthonormal=function(e,u){void 0==u&&(u=new n(16)),t.transpose(e,u);var i=[e[12],e[13],e[14]];return u[3]=u[7]=u[11]=0,u[12]=-r.dot([u[0],u[4],u[8]],i),u[13]=-r.dot([u[1],u[5],u[9]],i),u[14]=-r.dot([u[2],u[6],u[10]],i),u},t.inverseTo3x3=function(r,t){void 0==t&&(t=new n(9));var e=r[10]*r[5]-r[6]*r[9],u=-r[10]*r[1]+r[2]*r[9],i=r[6]*r[1]-r[2]*r[5],a=-r[10]*r[4]+r[6]*r[8],o=r[10]*r[0]-r[2]*r[8],c=-r[6]*r[0]+r[2]*r[4],l=r[9]*r[4]-r[5]*r[8],f=-r[9]*r[0]+r[1]*r[8],s=r[5]*r[0]-r[1]*r[4],p=r[0]*e+r[1]*a+r[2]*l;if(0==p)throw"matrix not invertible";var v=1/p;return t[0]=v*e,t[1]=v*u,t[2]=v*i,t[3]=v*a,t[4]=v*o,t[5]=v*c,t[6]=v*l,t[7]=v*f,t[8]=v*s,t},t.makeFrustum=function(r,t,e,u,i,a,o){void 0==o&&(o=new n(16));return o[0]=2*i/(t-r),o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*i/(u-e),o[6]=0,o[7]=0,o[8]=(t+r)/(t-r),o[9]=(u+e)/(u-e),o[10]=-(a+i)/(a-i),o[11]=-1,o[12]=0,o[13]=0,o[14]=-2*a*i/(a-i),o[15]=0,o},t.makePerspective=function(n,r,e,u,i){var a=e*Math.tan(n*Math.PI/360),o=-a,c=o*r,l=a*r;return t.makeFrustum(c,l,o,a,e,u,i)},t.makeOrtho=function(r,t,e,u,i,a,o){void 0==o&&(o=new n(16));return o[0]=2/(t-r),o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/(u-e),o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/(a-i),o[11]=0,o[12]=-(t+r)/(t-r),o[13]=-(u+e)/(u-e),o[14]=-(a+i)/(a-i),o[15]=1,o},t.makeOrtho2D=function(n,r,e,u,i){return t.makeOrtho(n,r,e,u,-1,1,i)},t.mul=function(r,t,e){void 0==e&&(e=new n(16));var u=r[0],i=r[1],a=r[2],o=r[3],c=r[4],l=r[5],f=r[6],s=r[7],p=r[8],v=r[9],h=r[10],m=r[11],d=r[12],g=r[13],y=r[14],w=r[15],_=t[0],x=t[1],b=t[2],k=t[3],A=t[4],j=t[5],O=t[6],M=t[7],S=t[8],F=t[9],E=t[10],T=t[11],I=t[12],R=t[13],q=t[14],z=t[15];return e[0]=u*_+c*x+p*b+d*k,e[1]=i*_+l*x+v*b+g*k,e[2]=a*_+f*x+h*b+y*k,e[3]=o*_+s*x+m*b+w*k,e[4]=u*A+c*j+p*O+d*M,e[5]=i*A+l*j+v*O+g*M,e[6]=a*A+f*j+h*O+y*M,e[7]=o*A+s*j+m*O+w*M,e[8]=u*S+c*F+p*E+d*T,e[9]=i*S+l*F+v*E+g*T,e[10]=a*S+f*F+h*E+y*T,e[11]=o*S+s*F+m*E+w*T,e[12]=u*I+c*R+p*q+d*z,e[13]=i*I+l*R+v*q+g*z,e[14]=a*I+f*R+h*q+y*z,e[15]=o*I+s*R+m*q+w*z,e},t.mulOffset=function(n,r,t,e){var u=n[1],i=n[2],a=n[3],o=n[4],c=n[5],l=n[6],f=n[7],s=n[8],p=n[9],v=n[10],h=n[11],m=n[12],d=n[13],g=n[14],y=n[15],w=r[0],_=r[1],x=r[2],b=r[3],k=r[4],A=r[5],j=r[6],O=r[7],M=r[8],S=r[9],F=r[10],E=r[11],T=r[12],I=r[13],R=r[14],q=r[15];return t[e+0]=a11*w+o*_+s*x+m*b,t[e+1]=u*w+c*_+p*x+d*b,t[e+2]=i*w+l*_+v*x+g*b,t[e+3]=a*w+f*_+h*x+y*b,t[e+4]=a11*k+o*A+s*j+m*O,t[e+5]=u*k+c*A+p*j+d*O,t[e+6]=i*k+l*A+v*j+g*O,t[e+7]=a*k+f*A+h*j+y*O,t[e+8]=a11*M+o*S+s*F+m*E,t[e+9]=u*M+c*S+p*F+d*E,t[e+10]=i*M+l*S+v*F+g*E,t[e+11]=a*M+f*S+h*F+y*E,t[e+12]=a11*T+o*I+s*R+m*q,t[e+13]=u*T+c*I+p*R+d*q,t[e+14]=i*T+l*I+v*R+g*q,t[e+15]=a*T+f*I+h*R+y*q,t},t.mulAffine=function(r,t,e){void 0==e&&(e=new n(16));var u=r[0],i=r[1],a=r[2],o=r[4],c=r[5],l=r[6],f=r[8],s=r[9],p=r[10],v=r[12],h=r[13],m=r[14],d=t[0],g=t[1],y=t[2],w=t[4],_=t[5],x=t[6],b=t[8],k=t[9],A=t[10],j=t[12],O=t[13],M=t[14];return e[0]=u*d+o*g+f*y,e[1]=i*d+c*g+s*y,e[2]=a*d+l*g+p*y,e[3]=0,e[4]=u*w+o*_+f*x,e[5]=i*w+c*_+s*x,e[6]=a*w+l*_+p*x,e[7]=0,e[8]=u*b+o*k+f*A,e[9]=i*b+c*k+s*A,e[10]=a*b+l*k+p*A,e[11]=0,e[12]=u*j+o*O+f*M+v,e[13]=i*j+c*O+s*M+h,e[14]=a*j+l*O+p*M+m,e[15]=1,e},t.mulAffine=function(r,t,e,u){void 0==e&&(e=new n(16));var i=r[0],a=r[1],o=r[2],c=r[4],l=r[5],f=r[6],s=r[8],p=r[9],v=r[10],h=r[12],m=r[13],d=r[14],g=t[0],y=t[1],w=t[2],_=t[4],x=t[5],b=t[6],k=t[8],A=t[9],j=t[10],O=t[12],M=t[13],S=t[14];return e[u+0]=i*g+c*y+s*w,e[u+1]=a*g+l*y+p*w,e[u+2]=o*g+f*y+v*w,e[u+3]=0,e[u+4]=i*_+c*x+s*b,e[u+5]=a*_+l*x+p*b,e[u+6]=o*_+f*x+v*b,e[u+7]=0,e[u+8]=i*k+c*A+s*j,e[u+9]=a*k+l*A+p*j,e[u+10]=o*k+f*A+v*j,e[u+11]=0,e[u+12]=i*O+c*M+s*S+h,e[u+13]=a*O+l*M+p*S+m,e[u+14]=o*O+f*M+v*S+d,e[u+15]=1,e},t.makeRotate=function(t,e,u){void 0==u&&(u=new n(16)),e=r.normalize(e,r._temp1);var i=e[0],a=e[1],o=e[2],c=Math.cos(t),l=1-c,f=Math.sin(t);return u[0]=i*i*l+c,u[1]=a*i*l+o*f,u[2]=o*i*l-a*f,u[3]=0,u[4]=i*a*l-o*f,u[5]=a*a*l+c,u[6]=a*o*l+i*f,u[7]=0,u[8]=i*o*l+a*f,u[9]=a*o*l-i*f,u[10]=o*o*l+c,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},t.rotate=function(r,t,e,u){void 0==u&&(u=new n(16));var i=t[0],a=t[1],o=t[2],c=Math.sqrt(i*i+a*a+o*o),l=i,f=a,s=o;if(1!=c){var p=1/c;l*=p,f*=p,s*=p}var v=Math.cos(r),h=1-v,m=Math.sin(r),d=l*m,g=f*m,y=s*m,w=l*f*h,_=l*s*h,x=f*s*h,b=e[0],k=e[1],A=e[2],j=e[3],O=e[4],M=e[5],S=e[6],F=e[7],E=e[8],T=e[9],I=e[10],R=e[11],q=l*l*h+v,z=w+y,N=_-g,B=w-y,D=f*f*h+v,P=x+d,$=_+g,L=x-d,C=s*s*h+v;return u[0]=b*q+O*z+E*N,u[1]=k*q+M*z+T*N,u[2]=A*q+S*z+I*N,u[3]=j*q+F*z+R*N,u[4]=b*B+O*D+E*P,u[5]=k*B+M*D+T*P,u[6]=A*B+S*D+I*P,u[7]=j*B+F*D+R*P,u[8]=b*$+O*L+E*C,u[9]=k*$+M*L+T*C,u[10]=A*$+S*L+I*C,u[11]=j*$+F*L+R*C,u!=e&&(u[12]=e[12],u[13]=e[13],u[14]=e[14],u[15]=e[15]),u},t.makeScale3=function(r,t,e,u){return void 0==u&&(u=new n(16)),u[0]=r,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=t,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=e,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},t.makeScale1=function(n,r){return t.makeScale3(n,n,n,r)},t.makeScale=function(n,r){return t.makeScale3(n[0],n[1],n[2],r)},t.scale3=function(r,t,e,u,i){return i==u?(u[0]*=r,u[1]*=r,u[2]*=r,u[3]*=r,u[4]*=t,u[5]*=t,u[6]*=t,u[7]*=t,u[8]*=e,u[9]*=e,u[10]*=e,u[11]*=e,u):(void 0==i&&(i=new n(16)),i[0]=u[0]*r,i[1]=u[1]*r,i[2]=u[2]*r,i[3]=u[3]*r,i[4]=u[4]*t,i[5]=u[5]*t,i[6]=u[6]*t,i[7]=u[7]*t,i[8]=u[8]*e,i[9]=u[9]*e,i[10]=u[10]*e,i[11]=u[11]*e,i[12]=u[12],i[13]=u[13],i[14]=u[14],i[15]=u[15],i)},t.scale1=function(r,t,e){return e==t?(t[0]*=r,t[1]*=r,t[2]*=r,t[3]*=r,t[4]*=r,t[5]*=r,t[6]*=r,t[7]*=r,t[8]*=r,t[9]*=r,t[10]*=r,t[11]*=r,t):(void 0==e&&(e=new n(16)),e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e)},t.scale=function(r,t,e){var u=r[0],i=r[1],a=r[2];return e==t?(t[0]*=u,t[1]*=u,t[2]*=u,t[3]*=u,t[4]*=i,t[5]*=i,t[6]*=i,t[7]*=i,t[8]*=a,t[9]*=a,t[10]*=a,t[11]*=a,t):(void 0==e&&(e=new n(16)),e[0]=t[0]*u,e[1]=t[1]*u,e[2]=t[2]*u,e[3]=t[3]*u,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e)},t.makeTranslate3=function(r,t,e,u){return void 0==u&&(u=new n(16)),u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=r,u[13]=t,u[14]=e,u[15]=1,u},t.makeTranslate1=function(n,r){return t.makeTranslate3(n,n,n,r)},t.makeTranslate=function(n,r){return t.makeTranslate3(n[0],n[1],n[2],r)},t.translate3Self=function(n,r,t,e){return e[12]+=e[0]*n+e[4]*r+e[8]*t,e[13]+=e[1]*n+e[5]*r+e[9]*t,e[14]+=e[2]*n+e[6]*r+e[10]*t,e[15]+=e[3]*n+e[7]*r+e[11]*t,e},t.translate3=function(r,t,e,u,i){if(i==u)return u[12]+=u[0]*r+u[4]*t+u[8]*e,u[13]+=u[1]*r+u[5]*t+u[9]*e,u[14]+=u[2]*r+u[6]*t+u[10]*e,u[15]+=u[3]*r+u[7]*t+u[11]*e,u;void 0==i&&(i=new n(16));var a=u[0],o=u[1],c=u[2],l=u[3],f=u[4],s=u[5],p=u[6],v=u[7],h=u[8],m=u[9],d=u[10],g=u[11];return i[0]=a,i[1]=o,i[2]=c,i[3]=l,i[4]=f,i[5]=s,i[6]=p,i[7]=v,i[8]=h,i[9]=m,i[10]=d,i[11]=g,i[12]=a*r+f*t+h*e+u[12],i[13]=o*r+s*t+m*e+u[13],i[14]=c*r+p*t+d*e+u[14],i[15]=l*r+v*t+g*e+u[15],i},t.translate1=function(n,r,e){return t.translate3(n,n,n,r,e)},t.translateSelf=function(n,r){var t=n[0],e=n[1],u=n[2];return r[12]+=r[0]*t+r[4]*e+r[8]*u,r[13]+=r[1]*t+r[5]*e+r[9]*u,r[14]+=r[2]*t+r[6]*e+r[10]*u,r[15]+=r[3]*t+r[7]*e+r[11]*u,r},t.translate=function(r,t,e){var u=r[0],i=r[1],a=r[2];if(e==t)return t[12]+=t[0]*u+t[4]*i+t[8]*a,t[13]+=t[1]*u+t[5]*i+t[9]*a,t[14]+=t[2]*u+t[6]*i+t[10]*a,t[15]+=t[3]*u+t[7]*i+t[11]*a,t;void 0==e&&(e=new n(16));var o=t[0],c=t[1],l=t[2],f=t[3],s=t[4],p=t[5],v=t[6],h=t[7],m=t[8],d=t[9],g=t[10],y=t[11];return e[0]=o,e[1]=c,e[2]=l,e[3]=f,e[4]=s,e[5]=p,e[6]=v,e[7]=h,e[8]=m,e[9]=d,e[10]=g,e[11]=y,e[12]=o*u+s*i+m*a+t[12],e[13]=c*u+p*i+d*a+t[13],e[14]=l*u+v*i+g*a+t[14],e[15]=f*u+h*i+y*a+t[15],e},t.makeLookAt=function(e,u,i,a){var o=r.direction(e,u,r._temp1),c=r.normalize(r.cross(i,o,r._temp2),r._temp2),l=r.normalize(r.cross(o,c,r._temp3),r._temp3),f=t._temp1,s=t._temp2;return f[0]=c[0],f[1]=l[0],f[2]=o[0],f[3]=0,f[4]=c[1],f[5]=l[1],f[6]=o[1],f[7]=0,f[8]=c[2],f[9]=l[2],f[10]=o[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=-e[0],s[13]=-e[1],s[14]=-e[2],s[15]=1,void 0==a&&(a=new n(16)),t.mul(f,s,a)},t.transposeSelf=function(n){var r=n[1];return n[1]=n[4],n[4]=r,r=n[2],n[2]=n[8],n[8]=r,r=n[3],n[3]=n[12],n[12]=r,r=n[6],n[6]=n[9],n[9]=r,r=n[7],n[7]=n[13],n[13]=r,r=n[11],n[11]=n[14],n[14]=r,n},t.transpose=function(r,t){if(r==t){var e=0;return e=r[1],r[1]=r[4],r[4]=e,e=r[2],r[2]=r[8],r[8]=e,e=r[3],r[3]=r[12],r[12]=e,e=r[6],r[6]=r[9],r[9]=e,e=r[7],r[7]=r[13],r[13]=e,e=r[11],r[11]=r[14],r[14]=e,r}return void 0==t&&(t=new n(16)),t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=r[1],t[5]=r[5],t[6]=r[9],t[7]=r[13],t[8]=r[2],t[9]=r[6],t[10]=r[10],t[11]=r[14],t[12]=r[3],t[13]=r[7],t[14]=r[11],t[15]=r[15],t},t.transformPoint=function(r,t,e){void 0==e&&(e=new n(3));var u=t[0],i=t[1],a=t[2];e[0]=r[0]*u+r[4]*i+r[8]*a+r[12],e[1]=r[1]*u+r[5]*i+r[9]*a+r[13],e[2]=r[2]*u+r[6]*i+r[10]*a+r[14];var o=r[3]*u+r[7]*i+r[11]*a+r[15];return 1!=o&&(e[0]/=o,e[1]/=o,e[2]/=o),e},t.transformLine=function(r,t,e){void 0==e&&(e=new n(3));var u=t[0],i=t[1],a=t[2];e[0]=r[0]*u+r[4]*i+r[8]*a,e[1]=r[1]*u+r[5]*i+r[9]*a,e[2]=r[2]*u+r[6]*i+r[10]*a;var o=r[3]*u+r[7]*i+r[11]*a;return 1!=o&&(e[0]/=o,e[1]/=o,e[2]/=o),e},t.transformPointAffine=function(r,t,e){void 0==e&&(e=new n(3));var u=t[0],i=t[1],a=t[2];return e[0]=r[0]*u+r[4]*i+r[8]*a+r[12],e[1]=r[1]*u+r[5]*i+r[9]*a+r[13],e[2]=r[2]*u+r[6]*i+r[10]*a+r[14],e},t.transformLineAffine=function(r,t,e){void 0==e&&(e=new n(3));var u=t[0],i=t[1],a=t[2];return e[0]=r[0]*u+r[4]*i+r[8]*a,e[1]=r[1]*u+r[5]*i+r[9]*a,e[2]=r[2]*u+r[6]*i+r[10]*a,e};var e={V3:r,M4x4:t};return e}),define("utils",["underscore"],function(n){return function(r){r.isArray=function(r){return n.isArray(r)?!0:"Array]"==Object.prototype.toString.call(r).slice(-"Array]".length)}}}),define("shrike",["underscore","mjs","utils"],function(n,r,t){var e={};return t(e),e});